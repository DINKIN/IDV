<?xml version="1.0" encoding="UTF-8"?>


<project basedir="../../../" default="repositoryjar" name="Repository">

    <import file="../../build.xml"/>

    <target name="repository" depends="init,clean">
        <javac
            classpath="${classpath}"
            debug="true"
            source="${srcversion}"
            deprecation="false" 
            destdir="${compiledir}"
            failonerror="${failonerror}" 
            nowarn="true"
            srcdir="${srcdir}"
        >
        <include name="ucar/unidata/repository/**"/>
        </javac>
    </target>



    <target name="repositoryjar" depends="repository">
        <jar 
            basedir="${srcdir}"
            compress="true"
            update="false"
            jarfile="${jars_dest}/repositorytmp.jar">
            <include name="ucar/**/*.class"/>
            <include name="ucar/unidata/repository/htdocs/*.*"/>
            <include name="ucar/unidata/repository/resources/*.*"/>
        </jar>
        <mkdir dir="${tmpjardir}"/>
        <delete includeemptydirs="true">
            <fileset dir="${tmpjardir}" includes="**/*"/>
        </delete>
        <unjar src="${jars_dest}/repositorytmp.jar" dest="${tmpjardir}"/>
        <unjar src="${libsrc}/postgres.jar" dest="${tmpjardir}"/>
        <unjar src="${libsrc}/mysql.jar" dest="${tmpjardir}"/>
        <unjar src="${libsrc}/derby.jar" dest="${tmpjardir}"/>
        <unjar src="${libsrc}/derbytools.jar" dest="${tmpjardir}"/>
        <jar 
            basedir="${tmpjardir}"
            compress="true"
            manifest="${srcdir}/ucar/unidata/repository/repository.manifest"
            jarfile="${libsdir}/repository.jar">
              <include name="**"/>
        </jar>

        <delete dir="${tmpjardir}"/>
        <delete file="${jars_dest}/repositorytmp.jar"/>



    </target>


</project>
